import pandas as pd
import numpy as np
from faker import Faker
import random
from datetime import datetime, timedelta

fake = Faker('en_GB')
Faker.seed(42)
random.seed(42)

# Constants
num_records = 2000
locations = ["Norfolk County Council", "Suffolk County Council"]
categories = ["Electronics", "Home & Kitchen", "Fashion", "Sports", "Books"]
order_statuses = ["Pending", "Shipped", "Delivered", "Cancelled"]

# Date range: past 6 months
end_date = datetime.now()
start_date = end_date - timedelta(days=180)

# Data containers
data = []

# ID counters
customer_ids = [i for i in range(1, 301)]  # up to 300 customers
product_ids = [i for i in range(1, 51)]    # 50 products
supplier_ids = [i for i in range(1, 21)]   # 20 suppliers
inventory_ids = [i for i in range(1, 101)] # 100 inventory items

# Generate synthetic data
for serial_number in range(1, num_records + 1):
    customer_id = random.choice(customer_ids)
    order_id = serial_number
    product_id = random.choice(product_ids)
    supplier_id = random.choice(supplier_ids)
    inventory_id = random.choice(inventory_ids)
    
    customer_name = fake.name()
    gender = random.choice(["Male", "Female", "Other"])
    email = fake.unique.email()
    phone_number = fake.phone_number()
    address = fake.street_address() + ", " + random.choice(locations)
    
    product_name = fake.word().capitalize() + " " + random.choice(["Pro", "Lite", "Max"])
    product_category = random.choice(categories)
    
    supplier_name = fake.company()
    supplier_phone = fake.phone_number()
    supplier_email = fake.company_email()
    
    stock_quantity = random.randint(10, 500)
    quantity = random.randint(1, 5)
    unit_price = round(random.uniform(10.0, 500.0), 2)
    remaining_stock = stock_quantity - quantity
    
    order_date = fake.date_between(start_date=start_date, end_date=end_date)
    order_status = random.choice(order_statuses)
    
    data.append([
        serial_number, order_id, customer_id, customer_name, gender, email,
        phone_number, address, product_id, product_name, product_category,
        supplier_id, supplier_name, supplier_phone, supplier_email,
        inventory_id, random.choice(locations), stock_quantity, quantity,
        unit_price, order_date.strftime("%Y-%m-%d"), order_status, remaining_stock
    ])

# Create DataFrame
columns = [
    "serial_number", "order_id", "customer_id", "customer_name", "Gender", "email",
    "phone_number", "address", "product_id", "product_name", "product_category",
    "supplier_id", "supplier_name", "supplier_phone", "supplier_email",
    "inventory_id", "location", "stock_quantity", "quantity", "unit_price",
    "order_date", "order_status", "remaining_stock"
]

df = pd.DataFrame(data, columns=columns)

# Save as CSV
df.to_csv("norfolk_suffolk_dataset.csv", index=False)
print("âœ… Dataset generated: norfolk_suffolk_dataset.csv with", len(df), "records.")
